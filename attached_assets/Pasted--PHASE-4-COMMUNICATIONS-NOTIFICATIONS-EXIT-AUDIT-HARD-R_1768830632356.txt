 PHASE 4 ‚Äî COMMUNICATIONS & NOTIFICATIONS EXIT AUDIT

üö´ HARD RULES
	‚Ä¢	READ-ONLY AUDIT
	‚Ä¢	NO new features
	‚Ä¢	NO UI changes
	‚Ä¢	NO refactors
	‚Ä¢	NO schema changes
	‚Ä¢	NO permissions changes
	‚Ä¢	NO ‚Äúnice to have‚Äù improvements

Audit must only confirm correctness, safety, and completeness of what already exists.

‚∏ª

1Ô∏è‚É£ In-App Notifications

Verify:
	‚Ä¢	Notifications are created only for:
	‚Ä¢	New messages
	‚Ä¢	Order status changes
	‚Ä¢	System-required events
	‚Ä¢	Notifications:
	‚Ä¢	Belong to the correct user
	‚Ä¢	Cannot be read by other users
	‚Ä¢	Are marked read/unread correctly
	‚Ä¢	Notification count matches unread items
	‚Ä¢	No duplicate notifications for the same event

Must Confirm:
	‚Ä¢	No client-side creation of notifications
	‚Ä¢	No admin ability to inject notifications
	‚Ä¢	No cross-user leakage

‚∏ª

2Ô∏è‚É£ Messaging / Conversations (Buyer ‚Üî Vendor)

Verify:
	‚Ä¢	Conversations are created:
	‚Ä¢	Only when buyer initiates OR order context exists
	‚Ä¢	Messages:
	‚Ä¢	Are scoped strictly to participants
	‚Ä¢	Cannot be read by admin
	‚Ä¢	Cannot be read by other buyers/vendors
	‚Ä¢	Product references:
	‚Ä¢	Correctly link to the product
	‚Ä¢	Do not break if product is unpublished
	‚Ä¢	Attachments (images):
	‚Ä¢	Upload successfully
	‚Ä¢	Are visible only to participants

Must Confirm:
	‚Ä¢	No admin read access
	‚Ä¢	No message editing after send
	‚Ä¢	No impersonation paths
	‚Ä¢	No orphaned conversations

‚∏ª

3Ô∏è‚É£ Email Infrastructure (Foundation Only)

Verify:
	‚Ä¢	Email provider is connected
	‚Ä¢	Emails are triggered for:
	‚Ä¢	Account verification
	‚Ä¢	Password reset
	‚Ä¢	Critical system events only
	‚Ä¢	Email sending:
	‚Ä¢	Is server-side only
	‚Ä¢	Has retry protection
	‚Ä¢	Does not block core flows

Explicitly Confirm:
	‚Ä¢	No marketing emails
	‚Ä¢	No bulk sends
	‚Ä¢	No admin-triggered email blasts
	‚Ä¢	No email preference UI (out of scope)

‚∏ª

4Ô∏è‚É£ Permissions & Privacy

Verify:
	‚Ä¢	Buyer can only:
	‚Ä¢	Message vendors they interacted with
	‚Ä¢	See their own conversations
	‚Ä¢	Vendor can only:
	‚Ä¢	Message buyers from their products/orders
	‚Ä¢	See conversations tied to their products
	‚Ä¢	Admin:
	‚Ä¢	Cannot view messages
	‚Ä¢	Cannot send messages
	‚Ä¢	Cannot impersonate users

‚∏ª

5Ô∏è‚É£ Security & Abuse Safety (Passive)

Verify:
	‚Ä¢	All message endpoints:
	‚Ä¢	Require authentication
	‚Ä¢	Enforce ownership checks
	‚Ä¢	Rate limits exist (basic)
	‚Ä¢	No public conversation endpoints
	‚Ä¢	No message content rendered unsafely (XSS)

‚∏ª

6Ô∏è‚É£ Regression Checks

Confirm:
	‚Ä¢	Messaging does NOT affect:
	‚Ä¢	Checkout
	‚Ä¢	Orders
	‚Ä¢	Payments
	‚Ä¢	Reviews
	‚Ä¢	Notifications do NOT:
	‚Ä¢	Delay page loads
	‚Ä¢	Block navigation
	‚Ä¢	No console errors in:
	‚Ä¢	Buyer flows
	‚Ä¢	Vendor dashboard
	‚Ä¢	Admin dashboard

‚∏ª

‚úÖ PASS / FAIL CRITERIA

Phase 4 PASSES if:
	‚Ä¢	All checks above are ‚úÖ
	‚Ä¢	No privacy violations
	‚Ä¢	No admin overreach
	‚Ä¢	No crashes
	‚Ä¢	No feature creep detected

Phase 4 FAILS if:
	‚Ä¢	Admin can read messages
	‚Ä¢	Messages leak across users
	‚Ä¢	Notifications duplicate or misfire
	‚Ä¢	Email sends exceed foundational scope

‚∏ª

üèÅ FINAL OUTPUT REQUIRED FROM AGENT

A single audit report with:
	‚Ä¢	‚úÖ Passed checks
	‚Ä¢	‚ùå Failed checks (if any)
	‚Ä¢	File references for failures
	‚Ä¢	NO fixes implemented
