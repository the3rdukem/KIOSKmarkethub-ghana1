‚∏ª

PHASE 5A ‚Äî REVIEWS SYSTEM (STRICT, AUDIT-FIRST, PRODUCTION-SAFE)

ROLE

You are a senior marketplace systems engineer working on the KIOSK project.

You must:
	‚Ä¢	Audit what already exists before writing any code
	‚Ä¢	Not assume requirements
	‚Ä¢	Not add features outside this prompt
	‚Ä¢	Not regress existing flows

This phase is Reviews ONLY.
No notifications expansion, no moderation tooling beyond minimal, no reputation tiers.

‚∏ª

STEP 0 ‚Äî MANDATORY AUDIT (DO FIRST, REPORT ONLY)

Before implementing anything, audit and report:
	1.	Existing review-related files (API routes, DAL, UI components)
	2.	Current database schema related to reviews
	3.	Where reviews are displayed today (product/vendor/order pages)
	4.	Whether buyers already have a ‚ÄúReviews‚Äù page and what it does
	5.	Whether vendors can currently reply to reviews
	6.	Any coupling to orders, products, or vendors

‚ö†Ô∏è Do NOT modify code during audit
‚ö†Ô∏è Output an audit summary first and wait

‚∏ª

PHASE 5A ‚Äî LOCKED REQUIREMENTS (DO NOT DEVIATE)

1Ô∏è‚É£ Review Creation (Buyer)
	‚Ä¢	Reviews are created only by buyers
	‚Ä¢	Buyer may leave a review only after a completed order
	‚Ä¢	Review consists of:
	‚Ä¢	Rating (existing scale)
	‚Ä¢	Text and photo content
	‚Ä¢	Review is immutable after edit window expires

‚∏ª

2Ô∏è‚É£ Buyer Edit Window (STRICT)
	‚Ä¢	Buyer may edit their review:
	‚Ä¢	Within 15 minutes of creation
	‚Ä¢	ONLY if vendor has NOT replied
	‚Ä¢	After either condition fails:
	‚Ä¢	Review becomes permanently locked
	‚Ä¢	No version history required
	‚Ä¢	Track:
	‚Ä¢	edited_at
	‚Ä¢	Do NOT store old content

‚∏ª

3Ô∏è‚É£ Vendor Reply (SINGLE, APPEND-ONLY)
	‚Ä¢	Vendor may post exactly ONE reply
	‚Ä¢	Vendor reply:
	‚Ä¢	Cannot be edited
	‚Ä¢	Cannot be deleted
	‚Ä¢	Is append-only
	‚Ä¢	Vendor reply permanently locks the review from buyer edits
	‚Ä¢	No additional buyer replies allowed

üö´ NO threaded discussions
üö´ NO back-and-forth
üö´ NO messaging crossover

Reviews remain trust artifacts, not conversations.

‚∏ª

4Ô∏è‚É£ Buyer Follow-Up Replies (EXPLICITLY DISALLOWED)
	‚Ä¢	Buyers CANNOT reply after vendor reply
	‚Ä¢	Buyers CANNOT add follow-up comments
	‚Ä¢	Buyers CANNOT reopen reviews

If disputes occur, they must go through Messaging, not Reviews.

‚∏ª

5Ô∏è‚É£ UI / Page Scope (STRICT)
	‚Ä¢	‚ùå No standalone Buyer ‚ÄúMy Reviews‚Äù page
	‚Ä¢	Reviews appear only:
	‚Ä¢	On product pages
	‚Ä¢	On vendor pages
	‚Ä¢	Inline with completed orders
	‚Ä¢	Buyer may:
	‚Ä¢	See their own review in order history
	‚Ä¢	Edit only within allowed window

‚∏ª

6Ô∏è‚É£ Permissions & Security
	‚Ä¢	Buyers:
	‚Ä¢	See only their own review edit controls
	‚Ä¢	Vendors:
	‚Ä¢	Can reply only to reviews on their products
	‚Ä¢	Admin:
	‚Ä¢	Read-only access
	‚Ä¢	No editing
	‚Ä¢	No impersonation
	‚Ä¢	All access must be enforced server-side

‚∏ª

7Ô∏è‚É£ Database Expectations

If schema changes are required:
	‚Ä¢	Add minimal fields only:
	‚Ä¢	edited_at
	‚Ä¢	vendor_reply
	‚Ä¢	vendor_replied_at
	‚Ä¢	No new tables unless strictly necessary
	‚Ä¢	No soft deletes
	‚Ä¢	No review history tables

‚∏ª

8Ô∏è‚É£ Regression Guarantees (MANDATORY)

You MUST confirm:
	‚Ä¢	Orders are unaffected
	‚Ä¢	Messaging is unaffected
	‚Ä¢	Notifications are unaffected
	‚Ä¢	Search results are unaffected
	‚Ä¢	Checkout is unaffected
	‚Ä¢	No new environment variables added

‚∏ª

EXIT CRITERIA (REQUIRED)

You must produce:
	1.	Post-implementation audit report
	2.	Confirmation that:
	‚Ä¢	Buyer edit window enforced
	‚Ä¢	Vendor reply limited to one
	‚Ä¢	No buyer follow-ups possible
	3.	Confirmation that:
	‚Ä¢	No new pages were added
	‚Ä¢	No existing flows were broken

If ANY requirement cannot be met, STOP and report before proceeding.

‚∏ª

NON-GOALS (DO NOT IMPLEMENT)
	‚Ä¢	‚ùå Review moderation tools
	‚Ä¢	‚ùå Abuse reporting
	‚Ä¢	‚ùå Reputation scoring
	‚Ä¢	‚ùå Notifications
	‚Ä¢	‚ùå Vendor ratings aggregation changes
	‚Ä¢	‚ùå Admin actions beyond read-only

‚∏ª

FINAL INSTRUCTION

This phase must be:
	‚Ä¢	Minimal
	‚Ä¢	Deterministic
	‚Ä¢	Trust-preserving
	‚Ä¢	Shippable without future rewrites

Do not proceed without passing the audit first.

‚∏ª

