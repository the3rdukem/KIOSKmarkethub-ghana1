PHASE 7D ‚Äî STRICT DELIVERY IMPLEMENTATION MASTER PROMPT

ROLE

You are acting as a Delivery Systems Implementer, not a product designer, not a UX engineer, not an optimizer.

Your job is to enable courier-assisted delivery using the approved Phase 7A‚Äì7C design and existing locked UX.

‚∏ª

üö´ ABSOLUTE PROHIBITIONS (NON-NEGOTIABLE)

You are FORBIDDEN from:
	‚Ä¢	‚ùå Changing UX layout, spacing, or navigation
	‚Ä¢	‚ùå Adding or removing pages
	‚Ä¢	‚ùå Introducing new dashboards
	‚Ä¢	‚ùå Refactoring unrelated order logic
	‚Ä¢	‚ùå Touching authentication, payments, reviews, messaging
	‚Ä¢	‚ùå ‚ÄúImproving‚Äù responsiveness (UX is LOCKED)
	‚Ä¢	‚ùå Renaming statuses outside the approved model
	‚Ä¢	‚ùå Introducing real courier APIs
	‚Ä¢	‚ùå Storing rider PII (names, phones, GPS, photos)

If you think UX ‚Äúneeds adjustment‚Äù:
	‚Ä¢	STOP
	‚Ä¢	REPORT
	‚Ä¢	DO NOT IMPLEMENT

Any violation = FAILED PHASE

‚∏ª

üîê UX LOCK ACKNOWLEDGEMENT (MANDATORY)

Before proceeding, you must explicitly confirm:

‚ÄúPhase 6 UX/UI is locked. All delivery work will adapt to existing UI surfaces only.‚Äù

Failure to acknowledge = STOP

‚∏ª

üéØ PHASE 7D OBJECTIVE

Enable semi-automated delivery support that:
	‚Ä¢	Works with external couriers (Bolt, Uber, Yango, Qargo)
	‚Ä¢	Requires no courier API integration
	‚Ä¢	Preserves no-scam policy
	‚Ä¢	Adds auditability and dispute safety
	‚Ä¢	Does not alter buyer or vendor UX structure

This phase is about workflow enablement, not visual redesign.

‚∏ª

üì¶ APPROVED DELIVERY MODEL (DO NOT DEVIATE)

Order Status Track (FINAL)

created
‚Üí confirmed
‚Üí preparing
‚Üí ready_for_pickup
‚Üí out_for_delivery
‚Üí delivered
‚Üí completed (system only)

Item Fulfillment Track

pending
‚Üí packed
‚Üí handed_to_courier
‚Üí delivered

Payment Track

pending ‚Üí paid | failed | refunded


‚∏ª

üß© ALLOWED IMPLEMENTATION SURFACE (STRICT)

You may ONLY implement delivery using:

1Ô∏è‚É£ Existing Order Action Buttons
	‚Ä¢	Reuse current action slots
	‚Ä¢	Labels may change, layout may NOT

2Ô∏è‚É£ Modals / Dialogs
	‚Ä¢	Courier selection modal
	‚Ä¢	Courier reference input
	‚Ä¢	Confirmation dialogs

3Ô∏è‚É£ Backend Logic & APIs
	‚Ä¢	Status transitions
	‚Ä¢	Validation
	‚Ä¢	Audit logging
	‚Ä¢	Timers / background jobs

4Ô∏è‚É£ Notifications (Non-visual)
	‚Ä¢	Status change notifications
	‚Ä¢	Dispute reminders

‚∏ª

üöö DELIVERY IMPLEMENTATION REQUIREMENTS

A. Vendor Delivery Actions

Implement the following vendor actions ONLY when valid:
	1.	Mark Ready for Pickup
	‚Ä¢	Preconditions:
	‚Ä¢	Order = preparing
	‚Ä¢	All items = packed
	‚Ä¢	Effects:
	‚Ä¢	Order ‚Üí ready_for_pickup
	‚Ä¢	Timestamp logged
	2.	Select Courier
	‚Ä¢	Modal with options:
	‚Ä¢	Bolt
	‚Ä¢	Uber
	‚Ä¢	Yango
	‚Ä¢	Qargo
	‚Ä¢	Other
	‚Ä¢	Optional input:
	‚Ä¢	courier_reference (text)
	3.	Courier Booked
	‚Ä¢	Vendor confirms booking externally
	‚Ä¢	Order ‚Üí out_for_delivery
	‚Ä¢	Item fulfillment ‚Üí handed_to_courier
	4.	Mark Delivered
	‚Ä¢	Vendor declaration only
	‚Ä¢	Order ‚Üí delivered
	‚Ä¢	Sets delivered_at
	‚Ä¢	Starts 48-hour dispute window

‚∏ª

B. Courier Trigger Behavior (NO API INTEGRATION)

Allowed:
	‚Ä¢	Deep links (if supported)
	‚Ä¢	External site opening in new tab
	‚Ä¢	Pre-filled data via URL where possible

Explicitly forbidden:
	‚Ä¢	API keys
	‚Ä¢	Webhooks
	‚Ä¢	Tracking ingestion
	‚Ä¢	Rider identity storage

‚∏ª

C. Buyer Delivery Safeguards

Implement:
	‚Ä¢	48-hour dispute window (already built)
	‚Ä¢	Buyer dispute endpoint enforcement
	‚Ä¢	Clear delivery status visibility
	‚Ä¢	No buyer ‚Äúmark delivered‚Äù power

‚∏ª

D. System Automation (MANDATORY)

You MUST implement:
	‚Ä¢	Scheduled auto-completion
	‚Ä¢	delivered ‚Üí completed after 48h
	‚Ä¢	Skip if disputed
	‚Ä¢	Safe idempotent execution
	‚Ä¢	System actor attribution

If scheduling is not available:
	‚Ä¢	Document fallback (manual admin trigger)
	‚Ä¢	DO NOT silently skip

‚∏ª

üõ°Ô∏è SAFETY & ISOLATION RULES

Verify and enforce:
	‚Ä¢	Delivery logic does NOT:
	‚Ä¢	Trigger payouts
	‚Ä¢	Modify payment state
	‚Ä¢	Affect messaging
	‚Ä¢	Affect reviews
	‚Ä¢	Affect PWA behavior
	‚Ä¢	Admin retains override capability
	‚Ä¢	All transitions logged

‚∏ª

üß™ REQUIRED VALIDATION (BEFORE REPORTING DONE)

You MUST verify:
	‚Ä¢	Legacy orders still work
	‚Ä¢	New statuses render correctly
	‚Ä¢	Invalid transitions return 409
	‚Ä¢	Unauthorized actors receive 401/403
	‚Ä¢	Dispute window blocks auto-completion
	‚Ä¢	Courier fields are optional
	‚Ä¢	No UX regressions

‚∏ª

üìã REQUIRED OUTPUT FORMAT (STRICT)

You MUST output ONLY:

‚∏ª

üìã PHASE 7D ‚Äî DELIVERY IMPLEMENTATION REPORT

Implemented Features
	‚Ä¢	‚Ä¶

Status Transitions Enabled
	‚Ä¢	‚Ä¶

Courier Support
	‚Ä¢	‚Ä¶

Automation
	‚Ä¢	‚Ä¶

Guards & Protections
	‚Ä¢	‚Ä¶

Known Limitations
	‚Ä¢	‚Ä¶

‚∏ª

üö® BLOCKERS (IF ANY)
	‚Ä¢	If none, write: NONE

‚∏ª

‚úÖ PHASE 7D EXIT DECISION

Choose ONE:
	‚Ä¢	READY FOR DELIVERY SOFT LAUNCH
	‚Ä¢	BLOCKED ‚Äî FIX REQUIRED

(Max 5 lines)

‚∏ª

üõë FINAL STOP RULE

After reporting:
	‚Ä¢	‚ùå Do NOT continue to Phase 8
	‚Ä¢	‚ùå Do NOT suggest enhancements
	‚Ä¢	‚ùå Do NOT touch UX
	‚Ä¢	‚ùå Do NOT optimize

STOP. WAIT FOR APPROVAL.
